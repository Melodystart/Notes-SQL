# 中級約維安學習筆記

https://datainpoint.substack.com/s/jovyans

## 第七週 | SQL 起步走。
- 資料操作：創造（Create）、查詢（Read）、更新（Update）與刪除（Delete），這四個動作又可以簡稱為 CRUD。
-  SQL語言特性：
```
- 一段 SQL 敘述最後要以分號 ; 做為結束的標註。
- 保留字的大小寫並不會影響執行結果，也就是俗稱的大小寫不敏感（Case insensitive）。
- 常數有固定的書寫方式，像是文字要用一組單引號標註、數值可以直接寫作等。
- 保留字之間要以空格或者換行來區隔。
除了快速記憶 SQL 的語言特性，更推薦的作法是參考一份工作團隊、協作夥伴或者自己喜歡並且願意去遵從的風格指南（Style guide）
```
- 約維安計畫採用 Simon Holywell 的風格指南來寫作 SQL，其中值得注意的幾個重點有：
```
- 敘述換行與縮排是採用靠右對齊的編排格式。
- 保留字與函數採用全大寫。
- 命名的時候採用蛇形命名法（Snake case）。
```
- 首先將 Jupyter Notebook 與學習資料庫 imdb.db 相連：
`%LOAD sqlite3 db=imdb.db timeout=2 shared_cache=true`
- 最後是執行 SQL 的哈囉世界：
```
SELECT *
  FROM movies
 LIMIT 5;
 ```

## 第八週 | SQL 的基礎查詢。
-（完整的 SQL 保留字可以參考 https://www.w3schools.com/sql/sql_ref_keywords.asp）
```
SELECT FROM：選擇資料表欄位。
LIMIT：限制查詢結果的觀測值筆數。
ORDER BY：排序查詢結果。
WHERE：篩選資料表觀測值。
GROUP BY：為資料表觀測值分組。
HAVING：篩選分組查詢結果。
```
- SELECT FROM：選擇資料表欄位。
1. 從資料表選擇欄位的時候使用 SELECT 與 FROM 保留字指定欄位名稱與資料表名稱，若希望從資料表選擇「所有」欄位，可以使用星號（*）達成。
2. 從 movies 資料表選擇 title、release_year 與 director 欄位，並且在不同欄位名稱之間用逗號分隔。
```
SELECT title,
       release_year,
       director
  FROM movies;
```
3. 從 movies 資料表選擇 director 欄位，並且以 DISTINCT 保留字剔除重複值。
```
SELECT DISTINCT director
  FROM movies;
```
- LIMIT：限制查詢結果的觀測值筆數。
限制查詢結果的觀測值筆數時候使用 LIMIT 保留字指定希望限制為幾筆。
```
SELECT *
  FROM movies
 LIMIT 5;
```
- ORDER BY：排序查詢結果。
排序查詢結果的時候使用 ORDER BY 保留字指定欄位名稱，預設的情況由小到大、遞增排序（如果是英文則是由 A 到 Z、由 a 到 z）；使用 DESC 保留字更改為由大到小、遞減排序（如果是英文則是由 z 到 a、由 Z 到 A）。
```
SELECT title,
       release_year,
       director
  FROM movies
 ORDER BY release_year DESC,
          title;
 ```
 - WHERE：篩選資料表觀測值。
篩選資料表觀測值的時候使用 WHERE 保留字指定條件，條件的生成可以透過兩種不同的運算符號：
關係運算符（Relational operators），例如大於（>）、小於（<）以及等於（=）等。
邏輯運算符（Logical operators），例如交集（AND）以及聯集（OR）等。
 ```
SELECT title,
       release_year,
       director
  FROM movies
 WHERE release_year = 1994 AND
       title = 'Forrest Gump';
 ```
 - GROUP BY：分組。
為資料表觀測值分組的時候使用 GROUP BY 保留字指定欄位名稱，分組的觀念可以視為 DISTINCT 與 ORDER BY 的結合。
```
SELECT director
  FROM movies
 GROUP BY director;
 ```
 - HAVING：篩選分組查詢結果 (像WHERE, 用在運算後欄位篩選)。
篩選分組查詢結果的時候使用 HAVING 保留字指定條件，條件的生成同樣可以透過關係運算符或者邏輯運算符。
留意COUNT(*) AS新增計數欄位要放在SELECT那區。
```
SELECT director,
       COUNT(*) AS number_of_movies
  FROM movies
 GROUP BY director
HAVING number_of_movies > 5;
```

## 第九週 | SQL 的中級查詢。
-在沒有 FROM 保留字的情況下，SELECT 保留字其實也能夠單獨存在於一段 SQL 之中，由於沒有指定欄位的資料表來源，SELECT 保留字後頭所接的內容就是所謂的「常數」，在 SQLite 關聯式資料庫管理系統之中，有四種常數：整數（INTEGER）、帶小數點的浮點數（REAL）、用單引號圈起的文字（TEXT）、空值或遺漏值（NULL）。
```
SELECT 5566 AS an_integer,
       5566.0 AS a_real,
       'Hello, World!' AS a_text,
       NULL AS a_null;
```
-數值運算符：運算結果生成整數或浮點數的符號，包含 + - * / 與 () 等常見運算符號。
```
SELECT 55 + 66 AS add_operator,
       55 - 66 AS subtract_operator,
       5 * 6 AS multiply_operator,
       56 / 112.0 AS divide_operator;
```
-關係運算符：運算結果生成布林（整數 0 表示 false、整數 1 表示真 true）的符號，包含相等、不相等、大於（大於等於）、小於（小於等於）、BETWEEN 與 IN。
```
SELECT 55 = 66 AS equal_operator,
       55 != 66 AS not_equal_operator,
       55 > 55 AS greater_than_operator,
       55 >= 55 AS greater_than_equal_to_operator,
       66 < 66 AS less_than_operator,
       66 <= 66 AS less_than_equal_to_operator,
       55 BETWEEN 54 AND 56 AS between_operator,
       55 IN (54, 55, 56) AS in_operator;
```
```
Getting a True only if both sides of and are True
Getting a False only if both sides of or are False
```
